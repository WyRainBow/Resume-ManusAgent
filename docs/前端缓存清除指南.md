# 前端缓存清除指南

## 📋 概述

OpenManus 前端使用 `localStorage` 存储聊天历史和简历数据。当遇到数据异常或需要重置时，可以清除这些缓存。

## 🧹 清除缓存的方法

### 方法 1：通过前端界面清除（推荐）

#### 清除聊天历史
1. 在聊天界面顶部，点击 **"清除历史"** 按钮
2. 这将清除所有聊天消息，但保留简历数据

#### 清除所有缓存
1. 在聊天界面顶部，点击 **"清除缓存"** 按钮
2. 确认对话框后，将清除：
   - 所有聊天消息
   - 所有简历数据
   - 所有界面设置

### 方法 2：通过浏览器开发者工具清除

#### 步骤 1：打开开发者工具
- **Chrome/Edge**: 按 `F12` 或 `Ctrl+Shift+I` (Windows) / `Cmd+Option+I` (Mac)
- **Firefox**: 按 `F12` 或 `Ctrl+Shift+I` (Windows) / `Cmd+Option+I` (Mac)
- **Safari**: 按 `Cmd+Option+I` (需要先在偏好设置中启用开发者菜单)

#### 步骤 2：打开 Application/Storage 标签
- **Chrome/Edge**: 点击 **Application** 标签
- **Firefox**: 点击 **Storage** 标签
- **Safari**: 点击 **Storage** 标签

#### 步骤 3：清除 localStorage
1. 在左侧面板找到 **Local Storage**
2. 展开 `http://localhost:5173` (或你的前端地址)
3. 找到以下键并删除：
   - `openmanus_chat_messages` - 聊天消息历史
   - `openmanus_resume_data` - 简历数据
   - `openmanus_show_resume_panel` - 简历面板显示状态

#### 步骤 4：刷新页面
按 `F5` 或 `Cmd+R` 刷新页面，缓存将被清除

### 方法 3：通过浏览器控制台清除（快速）

1. 打开浏览器开发者工具（`F12`）
2. 切换到 **Console** 标签
3. 执行以下命令：

```javascript
// 清除所有 OpenManus 相关缓存
localStorage.removeItem('openmanus_chat_messages');
localStorage.removeItem('openmanus_resume_data');
localStorage.removeItem('openmanus_show_resume_panel');

// 刷新页面
location.reload();
```

或者一次性清除所有 localStorage：

```javascript
// ⚠️ 注意：这会清除该网站的所有 localStorage 数据
localStorage.clear();
location.reload();
```

## 🔍 WebSocket 端口显示

### 功能说明

前端界面现在会在顶部状态栏显示当前连接的 WebSocket 端口号，格式为：`WS: 8080`

### 配置位置

WebSocket 端口配置在 `frontend/src/App.jsx` 中：

```javascript
const WS_CONFIG = {
  PORT: 8080,
  PATH: '/ws',
  getUrl: () => `ws://localhost:${WS_CONFIG.PORT}${WS_CONFIG.PATH}`
};
```

### 修改端口

如果需要修改 WebSocket 端口：

1. 编辑 `frontend/src/App.jsx`
2. 修改 `WS_CONFIG.PORT` 的值
3. 同时修改 `frontend/vite.config.js` 中的代理配置：

```javascript
proxy: {
  '/ws': {
    target: 'ws://localhost:8080',  // 修改为新的端口
    ws: true
  },
  '/api': 'http://localhost:8080'    // 修改为新的端口
}
```

4. 重启前端服务

## ⚠️ 注意事项

1. **清除缓存会丢失数据**：清除后无法恢复，请谨慎操作
2. **后端状态**：清除前端缓存不会清除后端 Agent 的状态，需要重启后端服务
3. **端口配置**：确保前端 WebSocket 端口与后端端口一致（默认 8080）

## 🐛 常见问题

### Q: 清除缓存后，为什么还有旧数据？

A: 可能是浏览器缓存了页面。尝试：
1. 硬刷新页面：`Ctrl+Shift+R` (Windows) / `Cmd+Shift+R` (Mac)
2. 清除浏览器缓存
3. 重启浏览器

### Q: WebSocket 连接失败怎么办？

A: 检查以下几点：
1. 确认后端服务正在运行（端口 8080）
2. 查看前端状态栏显示的端口号是否正确
3. 检查浏览器控制台是否有错误信息
4. 确认防火墙没有阻止连接

### Q: 如何查看当前使用的端口？

A: 前端界面顶部状态栏会显示 `WS: 8080`，表示当前连接的 WebSocket 端口。

## 📝 相关文件

- `frontend/src/App.jsx` - 前端主文件，包含缓存逻辑和 WebSocket 配置
- `frontend/vite.config.js` - Vite 配置，包含代理设置



