# æç¤ºè¯ç³»ç»Ÿä¼˜åŒ–

## è®¾è®¡ç†å¿µ

**åœ¨ä¿æŒç®€æ´çš„å‰æä¸‹ï¼Œæä¾›å¿…è¦çš„å·¥ç¨‹èƒ½åŠ›**

æœ¬é¡¹ç›®æç¤ºè¯ç³»ç»Ÿå‚è€ƒäº† **LangChain** å’Œ **MCP Agent** çš„è®¾è®¡ï¼Œå–ä¸¤è€…ç²¾åï¼š

| æ¥æº | å€Ÿé‰´å†…å®¹ |
|------|----------|
| **LangChain** | partial éƒ¨åˆ†å¡«å……ã€æ¨¡æ¿ç»„åˆã€è¾“å…¥éªŒè¯ |
| **MCP Agent** | ç®€æ´æ­£é¢è¡¨è¿°ã€æ¸…æ™°çš„æ­¥éª¤åˆ—è¡¨ |
| **é¡¹ç›®ç‰¹è‰²** | åœºæ™¯åŒ– Promptã€ç®€å†ä¸“ç”¨åŠŸèƒ½ |

---

## 1. å½“å‰æç¤ºè¯ç®¡ç†ç³»ç»Ÿåˆ†æ

### 1.1 ç›®å½•ç»“æ„

```
app/prompt/
â”œâ”€â”€ __init__.py           # æ¨¡å—å¯¼å‡º
â”œâ”€â”€ manus.py              # Manus Agent æç¤ºè¯
â”œâ”€â”€ toolcall.py           # Tool Calling åŸºç¡€æç¤ºè¯
â”œâ”€â”€ cv_analyzer.py        # CV åˆ†æ Agent æç¤ºè¯
â”œâ”€â”€ cv_reader.py          # CV è¯»å– Agent æç¤ºè¯
â”œâ”€â”€ browser.py            # Browser è‡ªåŠ¨åŒ–æç¤ºè¯
â”œâ”€â”€ mcp.py                # MCP åè®®æç¤ºè¯
â”œâ”€â”€ planning.py           # ä»»åŠ¡è§„åˆ’æç¤ºè¯
â”œâ”€â”€ swe.py                # è½¯ä»¶å·¥ç¨‹æç¤ºè¯
â””â”€â”€ visualization.py      # æ•°æ®å¯è§†åŒ–æç¤ºè¯
```

### 1.2 å½“å‰å®ç°æ–¹å¼

ä½¿ç”¨ Python å†…ç½®çš„ `str.format()` è¿›è¡Œå˜é‡æ’å€¼ï¼š

```python
# å®šä¹‰æç¤ºè¯
SYSTEM_PROMPT = """You are OpenManus...
The initial directory is: {directory}
Current state: {context}
"""

# ä½¿ç”¨æ—¶
system_prompt = SYSTEM_PROMPT.format(
    directory=config.workspace_root,
    context=context
)
```

### 1.3 å½“å‰ç³»ç»Ÿä¼˜ç‚¹

**åœºæ™¯åŒ– Prompt è®¾è®¡**
- æ¯ä¸ª Agent æœ‰å¤šä¸ªåœºæ™¯æç¤ºè¯
- CV Analyzer æœ‰ `SIMPLE_ANALYSIS_PROMPT`ã€`DEEP_ANALYSIS_PROMPT`
- CV Reader æœ‰ `INTRO_PROMPT`
- MCP Agent æœ‰ `TOOL_ERROR_PROMPT`ã€`MULTIMEDIA_RESPONSE_PROMPT`

**åŠ¨æ€ä¸Šä¸‹æ–‡æ³¨å…¥**
- Browser Agent é€šè¿‡ `format_next_step_prompt()` åŠ¨æ€æ ¼å¼åŒ–
- Manus Agent æ ¹æ® `ConversationState` åŠ¨æ€ç”Ÿæˆä¸Šä¸‹æ–‡

**ç®€æ´çš„å¯¼å…¥æ–¹å¼**
```python
from app.prompt.manus import SYSTEM_PROMPT, NEXT_STEP_PROMPT
from app.prompt.cv_analyzer import DEEP_ANALYSIS_PROMPT, ERROR_PROMPT
```

### 1.4 å½“å‰ç³»ç»Ÿä¸è¶³

| é—®é¢˜ | è¯´æ˜ | å½±å“ |
|------|------|------|
| æ— è¾“å…¥éªŒè¯ | å˜é‡ç¼ºå¤±æ—¶ Python åŸç”ŸæŠ¥é”™ï¼Œä¿¡æ¯ä¸æ¸…æ™° | è°ƒè¯•å›°éš¾ |
| æ— éƒ¨åˆ†å¡«å…… | æ— æ³•é¢„å¡«å……å¸¸ç”¨å˜é‡ï¼ˆå¦‚ç©ºç™½å ä½ç¬¦ï¼‰ | ä»£ç é‡å¤ |
| æ— æ¨¡æ¿ç»„åˆ | æ— æ³•é€šè¿‡ `+` æ‹¼æ¥å¤šä¸ªæ¨¡æ¿ç‰‡æ®µ | å¤ç”¨æ€§å·® |
| æ— èŠå¤©æ¨¡æ¿ | éœ€è¦æ‰‹åŠ¨æ„å»º Message åˆ—è¡¨ | ä¸ Memory é›†æˆéº»çƒ¦ |

---

## 2. LangChain æç¤ºè¯ç³»ç»Ÿåˆ†æ

### 2.1 æ ¸å¿ƒæ¶æ„

LangChain æç¤ºè¯ç³»ç»Ÿçº¦ 4000 è¡Œä»£ç ï¼ŒåŒ…å«ï¼š

| æ¨¡å— | è¡Œæ•° | åŠŸèƒ½ |
|------|------|------|
| chat.py | 1494 | ChatPromptTemplate èŠå¤©æ¨¡æ¿ |
| base.py | 465 | BasePromptTemplate æŠ½è±¡åŸºç±» |
| few_shot.py | 469 | FewShotPromptTemplate ç¤ºä¾‹ç®¡ç† |
| string.py | 319 | StringPromptTemplate å­—ç¬¦ä¸²æ¨¡æ¿ |
| prompt.py | 302 | PromptTemplate ä¸»å®ç° |
| loading.py | 203 | ä»æ–‡ä»¶åŠ è½½æç¤ºè¯ |

### 2.2 ä¾èµ–åˆ†æ

**å¼ºä¾èµ–é¡¹**
- pydantic - æ‰€æœ‰ç±»ç»§æ‰¿ BaseModel
- langchain_core.messages - Message ç±»å‹
- langchain_core.runnables - RunnableSerializable
- langchain_core.load - åºåˆ—åŒ–æ”¯æŒ

**ä¾èµ–å¤æ‚åº¦**: é«˜ï¼Œçº¦ 9 ä¸ªå†…éƒ¨æ¨¡å—

### 2.3 æ ¸å¿ƒåŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | LangChain | å½“å‰ç³»ç»Ÿ |
|------|-----------|----------|
| å˜é‡æ’å€¼ | str.format() | str.format() |
| è¾“å…¥éªŒè¯ | æœ‰ | æ—  |
| éƒ¨åˆ†å¡«å…… | partial() | æ—  |
| æ¨¡æ¿ç»„åˆ | æ”¯æŒ | æ—  |
| èŠå¤©æ¨¡æ¿ | ChatPromptTemplate | æ‰‹åŠ¨æ‹¼æ¥ |
| æ¶ˆæ¯å ä½ç¬¦ | MessagesPlaceholder | æ—  |
| æ–‡ä»¶åŠ è½½ | æœ‰ | æ—  |

---

## 3. ä¼˜åŒ–æ–¹æ¡ˆè®¾è®¡

### 3.1 è®¾è®¡åŸåˆ™

1. **ä¿ç•™ç°æœ‰ä¼˜ç‚¹** - åœºæ™¯åŒ– Promptã€ç®€æ´å¯¼å…¥
2. **æ— å¤–éƒ¨ä¾èµ–** - åªä½¿ç”¨ Python æ ‡å‡†åº“
3. **è‡ªåŠ¨å˜é‡æå–** - æ— éœ€æ‰‹åŠ¨å£°æ˜ input_variables
4. **å‘åå…¼å®¹** - ç°æœ‰ `.format()` è°ƒç”¨æ–¹å¼ä¸å˜

### 3.2 æ¨¡å—ç»“æ„

```
app/prompt/
â”œâ”€â”€ __init__.py           # æ›´æ–°å¯¼å‡º
â”œâ”€â”€ base.py               # æ–°å¢ï¼šPromptTemplate åŸºç±» (~150 è¡Œ)
â”œâ”€â”€ chat.py               # æ–°å¢ï¼šChatPromptTemplate (~80 è¡Œ)
â”œâ”€â”€ manus.py              # è¿ç§»ä½¿ç”¨æ–°æ¨¡æ¿
â”œâ”€â”€ mcp.py                # è¿ç§»ä½¿ç”¨æ–°æ¨¡æ¿
â”œâ”€â”€ cv_analyzer.py        # è¿ç§»ä½¿ç”¨æ–°æ¨¡æ¿
â”œâ”€â”€ cv_reader.py          # è¿ç§»ä½¿ç”¨æ–°æ¨¡æ¿
â””â”€â”€ ...
```

### 3.3 æ ¸å¿ƒ API è®¾è®¡

#### PromptTemplate

```python
class PromptTemplate:
    """è½»é‡çº§å­—ç¬¦ä¸²æ¨¡æ¿ï¼Œæ”¯æŒéªŒè¯å’Œéƒ¨åˆ†å¡«å……"""

    def __init__(self, template: str):
        """ä»å­—ç¬¦ä¸²åˆ›å»ºæ¨¡æ¿ï¼Œè‡ªåŠ¨æå–å˜é‡"""

    def format(self, **kwargs) -> str:
        """æ ¼å¼åŒ–æ¨¡æ¿ï¼ŒéªŒè¯å¿…éœ€å˜é‡
        Raises: ValueError å½“å˜é‡ç¼ºå¤±æ—¶
        """

    def partial(self, **kwargs) -> "PromptTemplate":
        """è¿”å›é¢„å¡«å……éƒ¨åˆ†å˜é‡çš„æ–°æ¨¡æ¿"""

    def __add__(self, other: Union["PromptTemplate", str]) -> "PromptTemplate":
        """æ‹¼æ¥æ¨¡æ¿ï¼št1 + t2 æˆ– template + "literal" """

    @property
    def variables(self) -> list[str]:
        """è·å–æ¨¡æ¿ä¸­çš„æ‰€æœ‰å˜é‡å"""
```

#### ChatPromptTemplate

```python
class ChatPromptTemplate:
    """èŠå¤©æ¶ˆæ¯æ¨¡æ¿ï¼Œç”Ÿæˆ Message åˆ—è¡¨"""

    def __init__(self, messages: list[tuple[str, str]]):
        """messages: [(role, template), ...]
        role: "system" | "user" | "assistant"
        """

    def format_messages(self, **kwargs) -> list[Message]:
        """æ ¼å¼åŒ–ä¸º Message å¯¹è±¡åˆ—è¡¨"""

    def partial(self, **kwargs) -> "ChatPromptTemplate":
        """é¢„å¡«å……å˜é‡"""
```

---

## 4. è¿ç§»ç¤ºä¾‹

### 4.1 Browser Agent - å±•ç¤º partial ä»·å€¼

**è¿ç§»å‰**
```python
# app/prompt/browser.py
NEXT_STEP_PROMPT = """
What should I do next...
- Current URL{url_placeholder}
- Available tabs{tabs_placeholder}
- Content above{content_above_placeholder}
- Content below{content_below_placeholder}
"""

# app/agent/browser.py
return NEXT_STEP_PROMPT.format(
    url_placeholder=url_info,
    tabs_placeholder=tabs_info,
    content_above_placeholder="",
    content_below_placeholder="",
    results_placeholder="",
)
```

**è¿ç§»å**
```python
# app/prompt/browser.py
from app.prompt.base import PromptTemplate

NEXT_STEP_PROMPT = PromptTemplate.from_template("""
What should I do next...
- Current URL{url_placeholder}
- Available tabs{tabs_placeholder}
...
""")

# é¢„å¡«å……ç©ºç™½å€¼ï¼ˆå®šä¹‰æ—¶ï¼‰
BASE_BROWSER_PROMPT = NEXT_STEP_PROMPT.partial(
    content_above_placeholder="",
    content_below_placeholder="",
    results_placeholder="",
)

# ä½¿ç”¨æ—¶ - åªä¼ åŠ¨æ€å˜é‡
return BASE_BROWSER_PROMPT.format(
    url_placeholder=url_info,
    tabs_placeholder=tabs_info,
)
```

### 4.2 CV Analyzer - å¢å¼ºè¾“å…¥éªŒè¯

**è¿ç§»å‰**
```python
# å˜é‡ç¼ºå¤±æ—¶ Python åŸç”ŸæŠ¥é”™ï¼šKeyError: 'å§“å'
result = SIMPLE_ANALYSIS_PROMPT.format(å§“å="", äº®ç‚¹1="", ...)
```

**è¿ç§»å**
```python
from app.prompt.base import PromptTemplate

SIMPLE_ANALYSIS_PROMPT = PromptTemplate.from_template("""
ã€åˆ†ææ•°æ®ã€‘
åŸºæœ¬ä¿¡æ¯: {å§“åã€å­¦æ ¡ã€ä¸“ä¸šã€æ±‚èŒæ„å‘}
äº®ç‚¹: [{äº®ç‚¹1}, {äº®ç‚¹2}, {äº®ç‚¹3}]
...
""")

# æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
# ValueError: Missing required variables: äº®ç‚¹3
result = SIMPLE_ANALYSIS_PROMPT.format(å§“å="", äº®ç‚¹1="", äº®ç‚¹2="")
```

### 4.3 æ¨¡æ¿ç»„åˆ

```python
# å®šä¹‰å¯å¤ç”¨ç‰‡æ®µ
greeting = PromptTemplate("ä½ å¥½ï¼Œæˆ‘æ˜¯ {name}ã€‚")
capabilities = PromptTemplate("æˆ‘å¯ä»¥å¸®ä½ ï¼š{skills}ã€‚")

# ç»„åˆä½¿ç”¨
full_intro = greeting + " " + capabilities
result = full_intro.format(name="OpenManus", skills="åˆ†æç®€å†ã€ä¼˜åŒ–å†…å®¹")
```

---

## 5. å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šåˆ›å»ºæ ¸å¿ƒæ¨¡æ¿ç³»ç»Ÿ

| æ­¥éª¤ | æ–‡ä»¶ | å†…å®¹ |
|------|------|------|
| 1 | app/prompt/base.py | PromptTemplate ç±» (~150 è¡Œ) |
| 2 | app/prompt/chat.py | ChatPromptTemplate ç±» (~80 è¡Œ) |
| 3 | app/prompt/__init__.py | å¯¼å‡ºå…¬å…± API |
| 4 | tests/test_prompt_templates.py | å•å…ƒæµ‹è¯• |

### é˜¶æ®µäºŒï¼šè¿ç§»ç°æœ‰æç¤ºè¯

| ä¼˜å…ˆçº§ | æ–‡ä»¶ | ç†ç”± |
|--------|------|------|
| 1 | browser.py | å±•ç¤º partial ä»·å€¼ |
| 2 | cv_analyzer.py | å¢åŠ è¾“å…¥éªŒè¯ |
| 3 | cv_reader.py | ç»Ÿä¸€æ¨¡æ¿æ ¼å¼ |
| 4 | manus.py | ä¸»æ¨¡å— |
| 5 | mcp.py | ä¿æŒç°æœ‰ç®€æ´æ€§ |
| 6 | å…¶ä»– | toolcall, planning, swe, visualization |

### é˜¶æ®µä¸‰ï¼šé«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰

- ä»æ–‡ä»¶åŠ è½½æç¤ºè¯ï¼ˆYAML/JSONï¼‰
- è°ƒè¯•æ¨¡å¼ï¼ˆæ‰“å°æ ¼å¼åŒ–åçš„æç¤ºè¯ï¼‰
- æç¤ºè¯ç‰ˆæœ¬ç®¡ç†

---

## 6. å®æ–½çŠ¶æ€

### å·²å®Œæˆ âœ…

**é˜¶æ®µä¸€ï¼šæ ¸å¿ƒæ¨¡æ¿ç³»ç»Ÿ**
- [x] app/prompt/base.py - PromptTemplate æ ¸å¿ƒç±» (~150 è¡Œ)
- [x] app/prompt/chat.py - ChatPromptTemplate (~90 è¡Œ)
- [x] app/prompt/__init__.py - å¯¼å‡º API
- [x] tests/test_prompt_templates.py - 37 ä¸ªæµ‹è¯•å…¨éƒ¨é€šè¿‡

**é˜¶æ®µäºŒï¼šç®€å†ä¸“ç”¨åŠŸèƒ½**
- [x] app/prompt/resume.py - ResumePromptTemplate (~130 è¡Œ)
- [x] app/prompt/star_framework.py - STAR æ¨¡æ¿ (~170 è¡Œ)
- [x] app/prompt/quality_metrics.py - è´¨é‡æŒ‡æ ‡ (~150 è¡Œ)

**é˜¶æ®µä¸‰ï¼šè¿ç§»ç°æœ‰ Agent**
- [x] cv_analyzer.py - é›†æˆ STAR æ¨¡æ¿
- [x] browser.py - ä½¿ç”¨ partial ç®€åŒ–
- [x] cv_reader.py - ä½¿ç”¨ PromptTemplate è·å¾—è¾“å…¥éªŒè¯

### å·²è·³è¿‡ï¼ˆæ— éœ€è¿ç§»ï¼‰

- [ ] cv_editor.py - ä¿æŒåŸæ ·ï¼ˆæ— éœ€ç»Ÿä¸€ä¸­æ–‡ï¼‰
- [ ] manus.py - ä¿æŒç®€æ´
- [ ] mcp.py - ä¿æŒç®€æ´

**é˜¶æ®µå››ï¼šé«˜çº§åŠŸèƒ½ï¼ˆå¯é€‰ï¼‰**
- [ ] è¡Œä¸šé€‚é…ï¼ˆtech/product/designï¼‰
- [ ] åŠ¨æ€æ¨¡æ¿é€‰æ‹©
- [ ] æ•ˆæœæµ‹è¯•æ¡†æ¶

---

## 7. æ–°å¢æ–‡ä»¶æ¸…å•

```
app/prompt/
â”œâ”€â”€ base.py               # PromptTemplate æ ¸å¿ƒç±»
â”œâ”€â”€ chat.py               # ChatPromptTemplate
â”œâ”€â”€ resume.py             # ResumePromptTemplate
â”œâ”€â”€ star_framework.py     # STAR åˆ†ææ¨¡æ¿å’Œå·¥å…·
â””â”€â”€ quality_metrics.py    # è´¨é‡è¯„ä¼°æŒ‡æ ‡ç³»ç»Ÿ

tests/
â””â”€â”€ test_prompt_templates.py  # å•å…ƒæµ‹è¯•ï¼ˆ37 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
```

---

## 8. ä½¿ç”¨ç¤ºä¾‹

### 8.1 åŸºç¡€æ¨¡æ¿ä½¿ç”¨

```python
from app.prompt.base import PromptTemplate

# åˆ›å»ºæ¨¡æ¿
template = PromptTemplate.from_template("Hello {name}!")
result = template.format(name="World")
# => "Hello World!"

# è¾“å…¥éªŒè¯
template.format()
# => ValueError: Missing required variables: name. Expected: name, Provided: (none)

# éƒ¨åˆ†å¡«å……
base = template.partial(name="OpenManus")
result = base.format()  # å·²ç»æœ‰ name äº†
# => "Hello OpenManus!"
```

### 8.2 æ¨¡æ¿ç»„åˆ

```python
from app.prompt.base import PromptTemplate

greeting = PromptTemplate("ä½ å¥½ï¼Œæˆ‘æ˜¯{name}ã€‚")
capabilities = PromptTemplate("æˆ‘å¯ä»¥å¸®ä½ ï¼š{skills}ã€‚")

full = greeting + " " + capabilities
result = full.format(name="OpenManus", skills="åˆ†æç®€å†ã€ä¼˜åŒ–å†…å®¹")
```

### 8.3 ç®€å†ä¸“ç”¨æ¨¡æ¿

```python
from app.prompt.resume import ResumePromptTemplate

# åˆ›å»ºç®€å†åˆ†ææ¨¡æ¿
template = ResumePromptTemplate.from_template("è¯·åˆ†æç®€å†ï¼š{content}")

# æ·»åŠ  STAR åˆ†ææ¡†æ¶
with_star = template.with_star_analysis()

# æ·»åŠ è´¨é‡è¯„ä¼°
with_metrics = with_star.with_quality_metrics()

# æ ¹æ®ç±»å‹é€‚é…
final = with_metrics.with_resume_profile("fresh_grad")
```

### 8.4 Browser Agent ä½¿ç”¨ partial

```python
from app.prompt.browser import BASE_BROWSER_PROMPT

# é¢„å¡«å……ç©ºç™½å€¼
result = BASE_BROWSER_PROMPT.format(
    url="https://example.com",
    tabs="2 tabs"
)
# åªéœ€ä¼ åŠ¨æ€å˜é‡ï¼Œabove/below/results å·²ç»é¢„å¡«å……ä¸ºç©ºå­—ç¬¦ä¸²
```

---

## 9. æ€»ç»“

### å½“å‰ç³»ç»ŸçŠ¶æ€

| ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|
| åœºæ™¯åŒ– Prompt è®¾è®¡ | æ— è¾“å…¥éªŒè¯ |
| åŠ¨æ€ä¸Šä¸‹æ–‡æ³¨å…¥ | æ— éƒ¨åˆ†å¡«å…… |
| ç®€æ´çš„å¯¼å…¥æ–¹å¼ | æ— æ¨¡æ¿ç»„åˆ |

### ä¼˜åŒ–æ–¹æ¡ˆç‰¹ç‚¹

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| è½»é‡çº§ | çº¦ 230 è¡Œä»£ç ï¼Œæ— å¤–éƒ¨ä¾èµ– |
| è‡ªåŠ¨å˜é‡æå– | æ— éœ€æ‰‹åŠ¨å£°æ˜ |
| è¾“å…¥éªŒè¯ | æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯ |
| éƒ¨åˆ†å¡«å…… | é¢„å¡«å……å¸¸ç”¨å€¼ |
| æ¨¡æ¿ç»„åˆ | æ”¯æŒ `+` æ“ä½œç¬¦ |

### é¢„æœŸæ•ˆæœ

- ä»£ç æ›´ç®€æ´ï¼ˆBrowser Agent å‡å°‘é‡å¤å‚æ•°ä¼ é€’ï¼‰
- è°ƒè¯•æ›´æ–¹ä¾¿ï¼ˆæ¸…æ™°çš„å˜é‡ç¼ºå¤±æç¤ºï¼‰
- å¤ç”¨æ€§æ›´å¥½ï¼ˆæ¨¡æ¿ç‰‡æ®µå¯ç»„åˆï¼‰
- ä¸ç°æœ‰ç³»ç»Ÿæ— ç¼é›†æˆ

---

## 10. æƒå¨å‚è€ƒè°ƒç ”ï¼ˆ2025ï¼‰

### 10.1 OpenManus è®¾è®¡ç‰¹ç‚¹

æ ¹æ® [OpenManus Promptç»„ä»¶è¯¦ç»†åˆ†æ](https://blog.csdn.net/weixin_40242845/article/details/146304050)ï¼š

**åŒæç¤ºè¯ç»“æ„**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  System Prompt          â”‚  Next Step Prompt                 â”‚
â”‚  â”œâ”€ å®šä¹‰è§’è‰²ã€èƒ½åŠ›è¾¹ç•Œ   â”‚  â”œâ”€ æŒ‡å¯¼æ¯æ­¥å†³ç­–å’Œè¡ŒåŠ¨            â”‚
â”‚  â”œâ”€ è®¾ç½®è¡Œä¸ºæ¨¡å¼         â”‚  â”œâ”€ æä¾›å·¥å…·è¯¦ç»†è¯´æ˜              â”‚
â”‚  â”œâ”€ ç®€æ´ï¼Œä¼šè¯æœŸé—´ä¸å˜   â”‚  â”œâ”€ è¾ƒè¯¦ç»†ï¼Œå¯åŠ¨æ€æ›´æ–°            â”‚
â”‚  â””â”€ åˆå§‹åŒ–æ—¶è®¾ç½®         â”‚  â””â”€ æ¯ä¸ª think æ­¥éª¤ä½¿ç”¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒè°ƒç”¨æµç¨‹**
```python
# 1. æ™ºèƒ½ä½“åˆå§‹åŒ–
class Manus(ToolCallAgent):
    system_prompt: str = SYSTEM_PROMPT
    next_step_prompt: str = NEXT_STEP_PROMPT

# 2. æ€è€ƒè¿‡ç¨‹ä¸­ä½¿ç”¨
async def think(self) -> bool:
    if self.next_step_prompt:
        user_msg = Message.user_message(self.next_step_prompt)
        self.messages += [user_msg]

    response = await self.llm.ask_tool(
        messages=self.messages,
        system_msgs=[Message.system_message(self.system_prompt)],
        tools=self.available_tools.to_params(),
    )

# 3. åŠ¨æ€æ¨¡æ¿å¤„ç†
self.next_step_prompt = self.next_step_prompt.format(
    current_dir=self.working_dir
)
```

---

### 10.2 LangChain 2025 æœ€ä½³å®è·µ

æ ¹æ® [LangChain å®˜æ–¹åšå®¢ - How to Build an Agent](https://blog.langchain.com/how-to-build-an-agent/) å’Œ [LangChain Best Practices](https://www.swarnendu.de/blog/langchain-best-practices/)ï¼š

#### æ„å»ºAgentçš„6æ­¥æ³•

```
Step 1: å®šä¹‰ä»»åŠ¡ï¼ˆ5-10ä¸ªå…·ä½“ä¾‹å­ï¼‰
   â†“ éªŒè¯èŒƒå›´æ˜¯å¦åˆç†
Step 2: è®¾è®¡æ“ä½œæµç¨‹ï¼ˆSOPï¼‰
   â†“ ç¼–å†™äººç±»æ‰§è¡Œæ­¥éª¤
Step 3: ç”¨ Prompt æ„å»º MVP
   â†“ èšç„¦æ ¸å¿ƒ LLM æ¨ç†ä»»åŠ¡
Step 4: è¿æ¥æ•°æ®å’Œç¼–æ’
   â†“ æ¥å…¥çœŸå®æ•°æ®æº
Step 5: æµ‹è¯•ä¸è¿­ä»£
   â†“ æ‰‹åŠ¨â†’è‡ªåŠ¨åŒ–æµ‹è¯•
Step 6: éƒ¨ç½²ã€æ‰©å±•å’Œä¼˜åŒ–
   â””â”€ ç›‘æ§å®é™…ä½¿ç”¨ï¼ŒæŒç»­æ”¹è¿›
```

#### Prompt å«ç”Ÿ

| å®è·µ | è¯´æ˜ | åº”ç”¨ |
|------|------|------|
| **æ¸…æ™°çš„ç³»ç»Ÿæ„å›¾** | å‡å°‘å¯å˜æ€§ | SYSTEM_PROMPT ç®€æ´æ˜ç¡® |
| **æ¨¡æ¿æç®€ä¸»ä¹‰** | ä¸åœ¨æç¤ºè¯ä¸­åµŒå…¥é•¿æ–‡æ¡£ | ç”¨ few-shot æˆ–ä¸Šä¸‹æ–‡æ–‡æ¡£ |

---

### 10.3 å¯å€Ÿé‰´çš„æ ¸å¿ƒæ€è·¯

| æ¥è‡ª | å¯å€Ÿé‰´ç‚¹ | åº”ç”¨åœºæ™¯ |
|------|----------|----------|
| **OpenManus** | System + NextStep åŒæç¤ºè¯ | âœ… å·²åœ¨ä½¿ç”¨ |
| **OpenManus** | åŠ¨æ€æ¨¡æ¿å¡«å…… | âœ… å·²å®ç° |
| **LangChain** | æ­£é¢ç®€æ´è¡¨è¿° | âœ… å·²åº”ç”¨ï¼ˆmanus.py, cv_analyzer.pyï¼‰ |
| **LangChain** | ç»“æ„åŒ–è¾“å‡º + éªŒè¯ | ğŸ“‹ æ¨¡å—åˆ†æå™¨çš„ JSON è¾“å‡º |

---

### 10.4 å‚è€ƒèµ„æº

**OpenManus ç›¸å…³**
- [OpenManus Promptç»„ä»¶è¯¦ç»†åˆ†æ - CSDN](https://blog.csdn.net/weixin_40242845/article/details/146304050)
- [FoundationAgents/OpenManus - GitHub](https://github.com/FoundationAgents/OpenManus)

**LangChain ç›¸å…³**
- [How to Build an Agent - LangChain Blog](https://blog.langchain.com/how-to-build-an-agent/)
- [LangChain Best Practices - Swarnendu De](https://www.swarnendu.de/blog/langchain-best-practices/)

---

### 10.5 å‚è€ƒèµ„æº

**OpenManus ç›¸å…³**
- [OpenManus Promptç»„ä»¶è¯¦ç»†åˆ†æ - CSDN](https://blog.csdn.net/weixin_40242845/article/details/146304050)
- [FoundationAgents/OpenManus - GitHub](https://github.com/FoundationAgents/OpenManus)
- [ManusæŠ€æœ¯æ¶æ„è®¾è®¡å‰–æ - AtBigApp](https://www.atbigapp.com/blog/1907322534164094976)

**LangChain ç›¸å…³**
- [How to Build an Agent - LangChain Blog](https://blog.langchain.com/how-to-build-an-agent/)
- [LangChain Best Practices - Swarnendu De](https://www.swarnendu.de/blog/langchain-best-practices/)
- [Building LangGraph: Agent Runtime - LangChain Blog](https://blog.langchain.com/building-langgraph/)
