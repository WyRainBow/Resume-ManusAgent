# 教育经历分析工具设计方案

> **模块标识**：`education`
> **优先级权重**：中（对于有工作经验的候选人）
> **分析方式**：规则引擎 + LLM + AI 知识库

---

## 1. 概述

### 1.1 模块定位

教育经历分析工具是 CVAnalyzer 协调者下的一个模块分析工具，专门负责分析简历中的教育背景信息，评估教育经历的质量和与目标岗位的匹配度。

### 1.2 核心设计理念

**利用 AI 知识库补充信息**：
- 教育经历、主修课程、相关荣誉等信息具有标准化特征
- 可通过 AI 知识库进行智能补充和标准化推断
- 基于院校、专业等已知信息，AI 可以推断：
  - 该专业通常开设的核心课程
  - 该院校/专业常见的荣誉类型
  - 该专业与目标岗位的匹配度
  - 标准化的课程描述和荣誉描述模板

### 1.3 分析目标

| 目标 | 说明 |
|------|------|
| **完整性检查** | 确保基本信息（院校、专业、学历）完整 |
| **质量评估** | 评估院校层次、专业匹配度、学术表现 |
| **匹配度分析** | 分析与目标岗位的相关性 |
| **优化建议** | 提供具体的教育背景优化方案 |

---

## 2. 分析维度

### 2.1 基本信息分析

#### 院校信息
- **院校层次**：985/211/双一流/普通本科/专科等
- **院校知名度**：在目标行业/地区的认可度
- **院校匹配度**：与目标岗位/公司的匹配程度

#### 学历层次
- **学历类型**：本科/硕士/博士/专科
- **学历完整性**：是否完成学业，是否有学位证
- **学历层次匹配度**：与目标岗位要求的学历是否匹配

#### 专业信息
- **专业名称**：具体专业名称
- **专业类别**：计算机类/软件工程类/电子信息类等
- **专业匹配度**：与目标岗位（如后端开发）的相关性
- **专业优势**：该专业在目标领域的优势

### 2.2 学术表现分析

#### GPA 评估
| GPA 范围 | 等级 | 竞争力 |
|---------|------|--------|
| 3.5+ / 4.0 | 优秀 | 高 |
| 3.0 - 3.5 / 4.0 | 良好 | 中 |
| < 3.0 / 4.0 | 一般 | 低 |

#### 专业排名
- **排名信息**：专业排名（如前15%）
- **排名优势**：排名在专业中的位置
- **排名缺失处理**：如果未提供排名，是否需要补充

#### 评估建议
- **是否需要补充**：如果 GPA 或排名缺失，建议补充
- **如何展示**：如果 GPA 不高，建议突出排名或其他优势

### 2.3 主修课程分析

#### 课程分类体系

```
基础课程（基石）
├── 高等数学
├── 线性代数
└── 概率论与数理统计

专业基础（核心）
├── 数据结构与算法
├── 操作系统
├── 计算机网络
└── 数据库原理

专业核心（深化）
├── 软件工程
├── 编译原理
└── 计算机组成原理

应用课程（方向）
├── Web开发
├── 移动开发
└── 人工智能
```

#### 后端开发核心课程匹配

| 课程类别 | 核心课程 | 权重 |
|---------|---------|------|
| 基础 | 数据结构与算法 | 必须 |
| 基础 | 操作系统 | 必须 |
| 基础 | 计算机网络 | 必须 |
| 基础 | 数据库原理 | 必须 |
| 重要 | 软件工程 | 重要 |
| 重要 | 计算机组成原理 | 重要 |
| 加分 | 分布式系统 | 加分 |
| 加分 | 系统设计 | 加分 |

### 2.4 相关荣誉分析

#### 荣誉类型识别

**奖学金**：
- 国家奖学金（最高级别）
- 校级奖学金
- 企业奖学金
- 其他专项奖学金

**荣誉称号**：
- 优秀学生/三好学生
- 优秀毕业生
- 优秀学生干部

**竞赛奖项**：
- 编程竞赛（ACM、蓝桥杯、LeetCode等）
- 算法竞赛
- 创新创业大赛
- 其他技术竞赛

#### 荣誉层次评估

| 层次 | 示例 | 含金量 |
|------|------|--------|
| 国家级 | 国家奖学金、ACM金牌 | 高 |
| 省级 | 省级竞赛一等奖 | 中高 |
| 校级 | 校级奖学金 | 中 |
| 院级 | 院级奖项 | 低 |

---

## 3. 输出格式规范

### 3.1 JSON 输出结构

```json
{
  "module": "education",
  "module_display_name": "教育经历",
  "score": 85,
  "priority_score": 35,
  "analysis_type": "deep",
  "strengths": [
    {
      "item": "专业匹配度高",
      "description": "计算机科学与技术专业，与后端开发高度相关",
      "evidence": "计算机科学与技术本科"
    },
    {
      "item": "学术表现良好",
      "description": "GPA 3.6/4.0，专业排名前15%",
      "evidence": "GPA: 3.6/4.0"
    }
  ],
  "weaknesses": [
    {
      "item": "缺少高级课程",
      "description": "未修读分布式系统、系统设计等高级课程",
      "impact": "无法体现系统设计能力",
      "suggestion": "通过项目经验或在线课程补充"
    }
  ],
  "issues": [
    {
      "id": "edu-1",
      "problem": "缺少分布式系统相关课程",
      "severity": "medium",
      "suggestion": "通过项目经验体现分布式系统能力"
    }
  ],
  "highlights": [
    "专业与目标岗位高度匹配",
    "核心课程完整，基础扎实",
    "GPA和排名信息完整"
  ],
  "details": {
    "institution": {
      "name": "广东药科大学",
      "level": "普通本科",
      "match_score": 60
    },
    "degree": {
      "type": "本科",
      "major": "计算机科学与技术",
      "match_score": 90
    },
    "gpa": {
      "value": 3.6,
      "scale": "4.0",
      "ranking": "前15%",
      "assessment": "良好"
    },
    "courses": {
      "core_courses": ["数据结构", "操作系统", "计算机网络", "数据库原理"],
      "advanced_courses": [],
      "match_score": 85,
      "missing_courses": ["分布式系统", "系统设计"]
    },
    "honors": {
      "scholarships": ["校级优秀学生奖学金"],
      "awards": ["计算机设计大赛省级二等奖"],
      "assessment": "荣誉较丰富"
    }
  }
}
```

### 3.2 分析报告模板（深度分析）

```markdown
## 📚 教育经历分析

### 一、基本信息评估

**院校信息**
- 院校：广东药科大学
- 层次：普通本科
- 匹配度：中等（在计算机领域认可度一般）

**学历层次**
- 学历：本科
- 专业：计算机科学与技术
- 匹配度：高（与后端开发高度相关）

### 二、学术表现评估

**GPA/排名**
- GPA：3.6/4.0
- 专业排名：前15%
- 评估：良好，在专业中表现优秀

### 三、课程匹配度分析

**核心课程** ✅
- 数据结构与算法（核心）
- 操作系统（核心）
- 计算机网络（核心）
- 数据库原理（核心）

**缺失课程** ⚠️
- 分布式系统（加分项）
- 系统设计（加分项）

**匹配度评分**：85/100

### 四、荣誉奖项评估

- 校级优秀学生奖学金
- 计算机设计大赛省级二等奖
- 程序设计竞赛一等奖

### 五、整体评价

**优势**：
1. 专业与目标岗位高度匹配
2. 核心课程完整，基础扎实
3. GPA和排名信息完整，学术表现良好

**可优化点**：
1. 院校层次一般，可通过项目经验弥补
2. 缺少高级课程，建议通过项目体现

**综合评分**：85/100
```

---

## 4. 匹配度评分规则

### 4.1 后端开发岗位匹配

| 维度 | 权重 | 评分标准 |
|------|------|----------|
| 专业匹配 | 30分 | 相关专业+20，完全匹配+30 |
| 课程匹配 | 30分 | 核心完整+30，有高级+10 |
| 学术表现 | 30分 | GPA 3.5++20，前10%+10 |
| 荣誉奖项 | 10分 | 有技术竞赛奖项+10 |

### 4.2 优先级计算

```python
priority_score = (100 - score) + severity_bonus

# severity_bonus
high   = +30
medium = +15
low    = +5

# 例子：教育经历 score=85，无 high 问题
priority_score = (100 - 85) + 0 = 15
```

---

## 5. AI 知识库应用场景

### 5.1 课程信息补充

**场景**：用户只写专业名称，无具体课程

**AI 应用**：
- 输入：专业名称（如"计算机科学与技术"）
- 输出：标准化的核心课程列表

### 5.2 荣誉信息补充

**场景**：荣誉信息不完整或描述不规范

**AI 应用**：
- 输入：专业类型
- 输出：标准化的荣誉描述模板

### 5.3 院校信息补充

**场景**：用户只写院校名称

**AI 应用**：
- 输入：院校名称
- 输出：院校层次、知名度、认可度评估

---

## 6. 特殊场景处理

### 6.1 信息缺失

| 缺失项 | 处理方案 |
|--------|----------|
| GPA | 建议补充，或通过其他方式体现学术能力 |
| 排名 | 建议补充，或突出其他优势 |
| 课程 | AI自动补充该专业核心课程列表 |
| 荣誉 | 提供标准化的荣誉描述模板 |

### 6.2 信息异常

| 异常类型 | 处理方式 |
|----------|----------|
| GPA异常高/低 | 验证数据准确性 |
| 课程与专业不匹配 | 进一步核实 |
| 荣誉与时间不匹配 | 验证时间线 |

---

## 7. 优秀示例参考

### 7.1 完整优秀示例

```
广东药科大学 | 计算机科学与技术专业 | 本科 | 2022.09 - 2026.06

GPA：3.8/4.0 (专业排名前5%)
主修课程：数据结构与算法、操作系统、计算机网络、数据库原理、Java程序设计、Web开发技术
荣誉奖项：连续两年获得校级一等奖学金、优秀学生干部
```

### 7.2 示例分析

| 要素 | 内容 | 评价 |
|------|------|------|
| 院校 | 广东药科大学 | 信息完整 |
| 专业 | 计算机科学与技术 | ✅ 与后端开发高度匹配 |
| GPA | 3.8/4.0 | ✅ 优秀水平 |
| 排名 | 前5% | ✅ 顶尖水平 |
| 课程 | 列出5门核心课程 | ✅ 覆盖后端开发核心 |
| 荣誉 | 一等奖学金x2 | ✅ 体现学术能力 |

### 7.3 不同水平示例

#### 优秀水平（90+分）

```
浙江大学 | 计算机科学与技术 | 本科 | 2020.09 - 2024.06
GPA：3.9/4.0 (专业排名前3%)
主修课程：数据结构、算法设计、操作系统、计算机网络、数据库系统、编译原理、分布式系统
荣誉奖项：国家奖学金、ACM竞赛全国银奖、浙江省优秀毕业生
```

#### 良好水平（75-89分）

```
某理工大学 | 软件工程 | 本科 | 2020.09 - 2024.06
GPA：3.5/4.0 (专业排名前20%)
主修课程：数据结构、Java编程、数据库原理、Web开发
荣誉奖项：校级奖学金、优秀学生干部
```

#### 一般水平（60-74分）

```
某大学 | 计算机科学与技术 | 本科 | 2020.09 - 2024.06
主修课程：计算机基础、C语言、数据库
```

---

## 8. 输出格式规范

### 8.1 分析流程输出格式

当用户说"分析一下我的简历"时，CVAnalyzer 协调者输出：

```markdown
━━━━━━━━━━━━━━━━━━━━━
📊 正在分析您的简历...
━━━━━━━━━━━━━━━━━━━━━

【识别到】分析简历整体

【调用工具】read_cv_context → education_analyzer(action="analyze")

━━━━━━━━━━━━━━━━━━━━━
📋 简历分析报告
━━━━━━━━━━━━━━━━━━━━━

【整体评分】85/100

【各模块评分】
• 教育背景: 85/100 ✅ 良好

【优势】
• 专业匹配度高：计算机科学与技术与后端开发工程师岗位高度相关
• 学术表现优秀：GPA 3.6/4.0，排名前15%
• 荣誉奖项丰富：获得校级一等奖学金和优秀学生干部称号

【需优化】
• 核心课程覆盖不够全面：缺少算法设计、数据库系统、软件工程等重要课程

━━━━━━━━━━━━━━━━━━━━━
💡 建议下一步：优化教育背景
━━━━━━━━━━━━━━━━━━━━━

回复"优化教育背景"，查看详细优化建议和示例。
```

### 8.2 优化流程输出格式

当用户说"优化教育背景"时，CVAnalyzer 协调者输出：

```markdown
━━━━━━━━━━━━━━━━━━━━━
📝 正在生成优化建议...
━━━━━━━━━━━━━━━━━━━━━

【识别到】优化教育背景

【调用工具】read_cv_context → education_analyzer(action="optimize", target_position="后端开发工程师")

━━━━━━━━━━━━━━━━━━━━━
💡 教育背景优化建议
━━━━━━━━━━━━━━━━━━━━━

### 📝 修改前后对比
**❌ 修改前**：
数据结构与算法、操作系统、计算机网络、数据库原理

**✅ 修改后**：
数据结构与算法、操作系统、计算机网络、数据库原理、Java程序设计、Web开发技术

### 💡 说明
列出与后端开发相关的核心课程，展示你的专业基础。建议选择 5-8 门成绩较好的课程。

### 📌 优化要点
• 优先列出与目标岗位相关的核心课程
• 按课程重要性排序，核心课程放前面
• 如果课程太多，只列出成绩较好的 5-8 门
• 可以包含实践类课程，如项目实战、课程设计等

### 📚 推荐课程
• 数据结构与算法
• 操作系统
• 计算机网络
• 数据库原理
• 软件工程

━━━━━━━━━━━━━━━━━━━━━
💡 建议下一步：分析工作经历
━━━━━━━━━━━━━━━━━━━━━

回复"分析工作经历"，查看详细分析报告。
```

---

## 9. 代码实现

### 9.1 文件结构

```
app/
├── agent/
│   ├── cv_analyzer.py              # CVAnalyzer 协调者
│   └── module/                     # 模块分析器目录
│       ├── __init__.py
│       ├── base_module_analyzer.py # 基类
│       └── education_analyzer.py   # 教育经历分析器
│
├── tool/
│   └── education_analyzer_tool.py  # 教育分析工具包装
│
└── prompt/
    └── module/
        ├── __init__.py
        └── education_prompt.py     # 教育 prompt 工具
```

### 9.2 BaseModuleAnalyzer 基类

```python
# app/agent/module/base_module_analyzer.py

from abc import ABC, abstractmethod
from typing import Dict, List, Optional
from app.agent.toolcall import ToolCallAgent

class BaseModuleAnalyzer(ToolCallAgent, ABC):
    """模块分析器基类"""

    # 子类必须定义
    module_name: str  # 如 "education"
    module_display_name: str  # 如 "教育经历"

    @abstractmethod
    async def analyze(self, resume_data: Dict) -> Dict:
        """分析模块，返回结构化结果

        Returns:
            {
                "module": "模块名",
                "score": 0-100,
                "priority_score": 0-100,
                "strengths": [...],
                "weaknesses": [...],
                "issues": [...],
                "highlights": [...],
                "details": {...}
            }
        """
        pass

    @abstractmethod
    async def optimize(self, resume_data: Dict, issue_id: Optional[str] = None) -> Dict:
        """生成优化建议和示例

        Returns:
            {
                "issue_id": "问题ID",
                "current": "当前内容",
                "optimized": "优化后的内容",
                "explanation": "优化说明",
                "before_after": {...},
                "tips": [...],
                "examples": [...]
            }
        """
        pass

    def _calculate_priority_score(self, score: int, issues: List, base_priority: int = 0) -> int:
        """计算优先级分数

        规则：
        - 基础分 = (100 - score)  # 分数越低，优先级越高
        - 有 high 严重问题 +30
        - 有 medium 严重问题 +15
        - 有 low 严重问题 +5
        """
        priority = (100 - score) + base_priority
        for issue in issues:
            severity = issue.get("severity", "low")
            if severity == "high":
                priority += 30
            elif severity == "medium":
                priority += 15
            elif severity == "low":
                priority += 5
        return min(priority, 100)  # 最高 100
```

### 9.3 EducationAnalyzer 实现

```python
# app/agent/module/education_analyzer.py

from app.agent.module.base_module_analyzer import BaseModuleAnalyzer
from app.prompt.module.education_prompt import (
    detect_institution_level,
    assess_gpa_level,
    match_major_with_backend,
    analyze_course_coverage,
)

class EducationAnalyzer(BaseModuleAnalyzer):
    """教育经历分析器"""

    name = "EducationAnalyzer"
    module_name = "education"
    module_display_name = "教育经历"

    async def analyze(self, resume_data: Dict) -> Dict:
        """分析教育经历"""
        education = resume_data.get("education", [])
        if not education:
            return self._empty_analysis()

        # 获取最高学历
        main_edu = self._get_highest_degree(education)

        # 各维度分析
        institution = main_edu.get("school", "")
        degree = main_edu.get("degree", "")
        major = main_edu.get("major", "")
        gpa = main_edu.get("gpa", "")
        courses = main_edu.get("courses", [])
        honors = main_edu.get("honors", [])

        # 计算评分
        institution_level = detect_institution_level(institution)
        major_score = match_major_with_backend(major)
        gpa_assessment = assess_gpa_level(gpa)
        course_analysis = analyze_course_coverage(courses)

        # 综合评分
        score = self._calculate_score({
            "institution": institution_level,
            "major": major_score,
            "gpa": gpa_assessment,
            "courses": course_analysis,
        })

        # 生成问题列表
        issues = self._generate_issues(main_edu)

        # 计算优先级
        priority_score = self._calculate_priority_score(score, issues)

        return {
            "module": self.module_name,
            "module_display_name": self.module_display_name,
            "score": score,
            "priority_score": priority_score,
            "strengths": self._get_strengths(main_edu),
            "weaknesses": self._get_weaknesses(main_edu),
            "issues": issues,
            "highlights": self._get_highlights(main_edu),
            "details": {
                "institution": {"name": institution, "level": institution_level},
                "degree": {"type": degree, "major": major, "match_score": major_score},
                "gpa": {"value": gpa, "assessment": gpa_assessment},
                "courses": course_analysis,
                "honors": {"count": len(honors)},
            }
        }

    async def optimize(self, resume_data: Dict, issue_id: Optional[str] = None) -> Dict:
        """生成优化建议"""
        if issue_id == "edu-courses":
            return self._optimize_courses(resume_data)
        elif issue_id == "edu-gpa":
            return self._optimize_gpa(resume_data)
        elif issue_id == "edu-honors":
            return self._optimize_honors(resume_data)
        else:
            # 默认优化课程
            return self._optimize_courses(resume_data)
```

### 9.4 EducationAnalyzerTool 工具包装

```python
# app/tool/education_analyzer_tool.py

from app.tool.base import BaseTool, ToolResult
from app.tool.resume_data_store import ResumeDataStore

class EducationAnalyzerTool(BaseTool):
    """教育经历分析工具"""

    name = "education_analyzer"
    description = """Analyze the education section of a resume.

    Use this tool when the user asks to:
    - "分析教育经历" (analyze education)
    - "教育背景怎么样" (how is the education background)
    - "优化教育背景" (optimize education)

    Parameters:
    - action: "analyze" or "optimize"
    - issue_id: (optional) specific issue ID to optimize
    - target_position: target job position for matching
    """

    parameters: dict = {
        "type": "object",
        "properties": {
            "action": {"type": "string", "enum": ["analyze", "optimize"]},
            "issue_id": {"type": "string"},
            "target_position": {"type": "string"},
        },
        "required": ["action"]
    }

    async def execute(
        self,
        action: str = "analyze",
        issue_id: Optional[str] = None,
        target_position: Optional[str] = None,
    ) -> ToolResult:
        """执行教育经历分析"""
        from app.agent.module.education_analyzer import EducationAnalyzer

        resume_data = ResumeDataStore.get_data()
        if not resume_data:
            return self.fail_response("No resume data loaded.")

        analyzer = EducationAnalyzer()
        if target_position:
            analyzer.set_target_position(target_position)

        if action == "analyze":
            result = await analyzer.analyze(resume_data)
            markdown = analyzer.format_analysis_as_markdown(result)
            return self.success_response(markdown)

        elif action == "optimize":
            result = await analyzer.optimize(resume_data, issue_id)
            markdown = self._format_optimization_result(result)
            return self.success_response(markdown)
```

### 9.5 Prompt 工具函数

```python
# app/prompt/module/education_prompt.py

def detect_institution_level(institution_name: str) -> str:
    """检测院校层次

    Returns:
        "985", "211", "双一流", "普通本科", "专科", "未知"
    """
    # 985 院校列表
    tier_985 = ["清华大学", "北京大学", "浙江大学", "复旦大学", ...]
    for school in tier_985:
        if school in institution_name:
            return "985"

    # 211 院校列表
    tier_211 = ["苏州大学", "上海大学", ...]
    for school in tier_211:
        if school in institution_name:
            return "211"

    # 其他判断...
    return "普通本科"

def assess_gpa_level(gpa: float, scale: float = 4.0) -> str:
    """评估 GPA 水平

    Returns:
        "优秀", "良好", "一般", "较差", "未知"
    """
    if gpa is None:
        return "未知"

    # 统一转换为 4.0 分制
    normalized_gpa = gpa / scale * 4.0

    if normalized_gpa >= 3.5:
        return "优秀"
    elif normalized_gpa >= 3.0:
        return "良好"
    elif normalized_gpa >= 2.5:
        return "一般"
    else:
        return "较差"

def match_major_with_backend(major: str) -> int:
    """匹配专业与后端开发的相关性

    Returns:
        0-100 的匹配分数
    """
    full_match_keywords = [
        "计算机科学与技术", "软件工程", "计算机",
        "Computer Science", "Software Engineering", "CS"
    ]
    for keyword in full_match_keywords:
        if keyword in major:
            return 100

    high_match_keywords = ["信息技术", "电子信息", "数学", "统计"]
    for keyword in high_match_keywords:
        if keyword in major:
            return 80

    partial_match_keywords = ["信息管理", "信息", "工程", "科学"]
    for keyword in partial_match_keywords:
        if keyword in major:
            return 60

    return 30

def analyze_course_coverage(courses: list[str]) -> dict:
    """分析课程覆盖度

    Returns:
        {
            "core_courses": [...],
            "advanced_courses": [...],
            "missing_courses": [...],
            "match_score": 0-100
        }
    """
    core_keywords = [
        "数据结构", "算法", "操作系统",
        "计算机网络", "数据库", "网络"
    ]
    advanced_keywords = [
        "分布式", "系统设计", "编译原理",
        "计算机组成", "软件工程"
    ]

    core_courses = []
    advanced_courses = []

    for course in courses:
        for keyword in core_keywords:
            if keyword in course:
                core_courses.append(course)
                break
        for keyword in advanced_keywords:
            if keyword in course:
                advanced_courses.append(course)
                break

    # 计算缺失的核心课程
    missing = []
    required = ["数据结构", "操作系统", "计算机网络", "数据库原理"]
    for req in required:
        if not any(req in c for c in courses):
            missing.append(req)

    # 计算匹配分数
    match_score = min(len(core_courses) * 15 + len(advanced_courses) * 10, 100)

    return {
        "core_courses": core_courses,
        "advanced_courses": advanced_courses,
        "missing_courses": missing,
        "match_score": match_score
    }
```

### 9.6 CVAnalyzer 协调者集成

```python
# app/agent/cv_analyzer.py

from app.tool.education_analyzer_tool import EducationAnalyzerTool
from app.tool.resume_data_store import ResumeDataStore

class CVAnalyzer(ToolCallAgent):
    """简历分析协调者"""

    available_tools: ToolCollection = Field(
        default_factory=lambda: ToolCollection(
            ReadCVContext(),
            EducationAnalyzerTool(),  # 添加教育分析工具
            Terminate(),
        )
    )

    def load_resume(self, resume_data: Dict) -> str:
        """加载简历数据到 Agent"""
        self._resume_data = resume_data

        # 设置共享的简历数据存储（供模块分析工具使用）
        ResumeDataStore.set_data(resume_data)

        # ... 其他初始化逻辑
```

---

## 10. 与其他模块的关联

| 关联模块 | 关联说明 |
|----------|----------|
| 工作经历 | 丰富的工作经历可弥补教育背景不足 |
| 项目经历 | 项目经验可体现课程知识的应用 |
| 技能模块 | 技能模块可验证课程知识的掌握程度 |
